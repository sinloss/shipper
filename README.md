# Shipper ships binary files as a go source file

It is espically used for shipping dynamic libraries and executables which
needs to get restored to the local file system.

After intallation via `go get -u github.com/sinloss/shipper`, you could use
`shipper` to do the shipping.

The usage is as follows:
```
Usage: shipper [options] <dir> <dest-file> [includes-without-gzip] [-- <includes-with-gzip>]
  Includes are comma seperated file paths in `dir`, wildcards are supportted. If there are
  none comma seperated file paths given, all the files in `dir` will be included without gzip
  by default
Options:
  -p string
        Specify the package name for the generated go file (default "main")
  -t string
        Specify the build tags for the generated go file
  -v string
        Specify the variable name of map containing all the embeded files (default "A")
```

# For example

execute `shipper helloworld helloworld.go *o -- *.bar` or use go generate
```go
//go:generate go get -u github.com/sinloss/shipper
//go:generate go run github.com/sinloss/shipper helloworld helloworld.go *o -- *.bar
```
on the following files which is provided as the [/helloworld](https://github.com/sinloss/shipper/tree/master/helloworld) folder of this repo.
```
 ┌───────────────────┬─────────┐
 │ FILESYSTEM        │ CONTENT │
 ├───────────────────┼─────────┤
 │ helloworld        │ <dir>   │
 │   ├─ hello        │ h       │
 │   └─ world        │ <dir>   │
 │        ├─ foo.bar │ f       │
 │        └─ bar.foo │ b       │
 └───────────────────┴─────────┘
```
would generate
```go
// Code generated by shipper; DO NOT EDIT.

package main

import (
	"github.com/sinloss/shipper/shipper"
)

// A is the Asset
var A = &shipper.Assets{

	"hello": shipper.Content{
		Gziped: false,
		Bytes:  []byte("\x68\x0d\x0a"),
	},
	"world/bar.foo": shipper.Content{
		Gziped: false,
		Bytes:  []byte("\x62\x0d\x0a"),
	},
	"world/foo.bar": shipper.Content{
		Gziped: true,
		Bytes:  []byte("\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\xff\x4a\x53\xe0\xe5\x02\x04\x00\x00\xff\xff\x70\xa6\x3f\x52\x04\x00\x00\x00"),
	},
}
```
which is also provided as [/shipped/helloworld.go](https://github.com/sinloss/shipper/blob/master/shipped/helloworld.go) in this repo yet with an additional flag `-p shipped` thus has the different package clause

# Restore

The files could be restored using it's facility function `Restore` or `RestoreAs` defined in [/shipper/facility.go](https://github.com/sinloss/shipper/blob/master/shipper/facility.go). You could refer to [/ship_test.go](https://github.com/sinloss/shipper/blob/master/ship_test.go) for sample codes.

# Gzip / UnGzip supported

Yes, supported.

# The O(M+N) wildcard searching

The wildcard searching technique is based on the `Knuth Morris Pratt DFA` substring matching algorithm. The original `Knuth Morris Pratt DFA` only deal with exact characters, and would not be able to deal with wildcards. And the wildcard searching algorithm in this repo on the other hand supported the wildcards and also greedy matching by took advantage of the `x` restart state, and dynamically evolve it when dealing with `?` wildcard to avoid the great time/space cost of building a `DFA` on all the possibilities of this undetermined `?`. As for `*`, it could be simply treated as a starting state shifted to the next character following it. 

This wildcard searching technique also introduced a **state based** data structure instead of the original **character based** which has a great space cost and underlying corresponding time cost proportional to the size of the alphabet. So that it could used an `any` key to represents all the other characters thus reduce the space and time cost.

To use this wildcard util in other places, one could `import "github.com/sinloss/shipper/wildcard"`. The examples of matching `[]rune` and `<-chan rune` lay in the [/wildcard/wildcard_test.go](https://github.com/sinloss/shipper/blob/master/wildcard/wildcard_test.go). Please take a look if you are interested.
